{"name":"inferenceHW/hw4","tagline":"Course materials for the Data Science Specialization: https://www.coursera.org/specialization/jhudatascience/1","body":"---\r\ntitle       : Homework 4 for Stat Inference\r\nsubtitle    : Extra problems for Stat Inference\r\nauthor      : Brian Caffo\r\njob         : Johns Hopkins Bloomberg School of Public Health\r\nframework   : io2012\r\nhighlighter : highlight.js  \r\nhitheme     : tomorrow       \r\n#url:\r\n#    lib: ../../librariesNew #Remove new if using old slidify\r\n#    assets: ../../assets\r\nwidgets     : [mathjax, quiz, bootstrap]\r\nmode        : selfcontained # {standalone, draft}\r\n---\r\n\r\n\r\n\r\n## About these slides\r\n- These are some practice problems for Statistical Inference Quiz 4\r\n- They were created using slidify interactive which you will learn in \r\nCreating Data Products\r\n- Please help improve this with pull requests here\r\n(https://github.com/bcaffo/courses)\r\n\r\n\r\n--- &multitext\r\nLoad the data set `mtcars` in the `datasets` R package. You want\r\nto test whether the MPG is $\\mu_0$ or smaller using a one sided\r\n5% level test. ($H_0 : \\mu = \\mu_0$ versus $H_a : \\mu < \\mu_0$).\r\nUsing that data set and a Z test:\r\n\r\n1. what is the smallest value of $\\mu_0$ that you would reject for?\r\n\r\nBoth to two decimal places.\r\n\r\n*** .hint\r\nThis is the inversion of a one sided hypothesis test. It yields confidence\r\nbounds. (Note inverting a two sidded test yields confidence intervals.) \r\nThink about the derivation of the confidence interval.\r\n\r\n*** .explanation\r\nWe want to solve \r\n$$\r\n\\frac{\\sqrt{n}(\\bar{X} - \\mu_0)}{s} = Z_{0.05}\r\n$$\r\nOr $$\\mu_0 = \\bar{X} - Z_{0.05} s / \\sqrt{n} = \\bar{X} + Z_{0.95} s / \\sqrt{n}$$. Note that the quantile is negative.\r\n\r\n\r\n```r\r\nmn <- mean(mtcars$mpg); s <- sd(mtcars$mpg); z <- qnorm(.05)\r\nmu0 <- mn - z * s / sqrt(nrow(mtcars))\r\n```\r\n\r\nNote, it's easy to get tripped up in this problem on signs. If you get a value\r\nthat's less than $\\bar X$, then clearly it's wrong, since you'd never reject for\r\n$H_0:\\mu = \\mu_0$ versus $H_a : \\mu < \\mu_0$ if $\\mu_0$ was less than your observed mean.\r\nAlso note the answer to \"What is the largest value for which you would reject for?\" is\r\ninfinity.\r\n\r\n<span class=\"answer\">21.84</span<>\r\n\r\n\r\n--- &multitext\r\nConsider again the `mtcars` dataset. Use a two group t-test to test\r\nthe hypothesis that the 4 and 6 cyl cars have the same mpg.  Use\r\na two sided test with unequal variances.\r\n\r\n1. Do you reject at the 5% level (enter 0 for no, 1 for yes).\r\n2. What is the P-value to 4 decimal places expressed as a proportion?\r\n\r\n\r\n*** .hint\r\nUse `t.test` with the options `var.equal=FALSE`, `paired=FALSE`,  `altnernative` as `two.sided`. \r\n\r\n*** .explanation\r\n\r\n\r\n```r\r\nm4 <- mtcars$mpg[mtcars$cyl == 4]\r\nm6 <- mtcars$mpg[mtcars$cyl == 6]\r\np <- t.test(m4, m6, paired = FALSE, alternative=\"two.sided\", var.equal=FALSE)$p.value\r\n```\r\n\r\nThe answer to 1. is <span class=\"answer\">1</span> <br>\r\nThe answer to 2. is <span class=\"answer\">4e-04</span>\r\n\r\n\r\n--- &multitext\r\nA sample of 100 men yielded an average PSA level of 3.0 with a sd of 1.1. What\r\nare the complete set of values that a 5% two sided Z test of $H_0 : \\mu = \\mu_0$ \r\nwould reject the null hypothesis for?\r\n\r\n1. Enter the lower value to 2 decimal places.\r\n2. Enter the upper value to 2 decimal places. \r\n\r\n*** .hint\r\nThis is equivalent to the confidence interval.\r\n\r\n*** .explanation\r\nThe answer to 1 is\r\n <span class=\"answer\">2.78</span><br>\r\nThe answer to 2 is <span class=\"answer\">2.78</span>\r\n\r\n\r\n--- &multitext\r\nYou believe the coin that you're flipping is biased towards heads. You get 55 heads out of \r\n100 flips. \r\n\r\n1. What's the exact relevant pvalue to 4 decimal places (expressed as a proportion)?\r\n2. Would you reject a 1 sided hypothesis at $\\alpha = .05$? (0 for no 1 for yes)?\r\n\r\n*** .hint\r\nUse `pbinom` for a hypothesis that $p=.5$ veruss $p>.5$ where $p$ is the binomial success\r\nprobability.\r\n\r\n*** .explanation\r\nNote you have to start at 54 as it `lower.tail = FALSE` gives the strictly greater than\r\nprobabilities\r\n\r\n```r\r\nans <- round(pbinom(54, prob = .5, size = 100, lower.tail = FALSE),4)\r\n```\r\n\r\nThe answer to 1 is <span class=\"answer\">0.1841</span><br>\r\nThe answer to 2 is <span class=\"answer\">0</span><br>\r\n\r\n\r\n--- &multitext\r\n\r\nA web site was monitored for a year and it received 520 hits per day. In the first\r\n30 days in the next year, the site received 15,800 hits. Assuming that web hits\r\nare Poisson.\r\n\r\n1. Give an exact one sided P-value to the hypothesis that web hits are up this year over last\r\nto four significant digits (expressed as a proportion).\r\n2. Does the one sided test reject (0 for no 1 for yes)?\r\n\r\n\r\n\r\n*** .hint\r\nConsider using `ppois` with $\\lambda=520 * 30$.  Note this is nearly exactly Gaussian, \r\nso one could get away with the Gaussian calculation.\r\n\r\n*** .explanation\r\nThis test comes with the important assumption that web hits are a Poisson process.\r\n\r\n\r\n```r\r\npv <- ppois(15800 - 1, lambda = 520 * 30, lower.tail = FALSE)\r\n```\r\n\r\n\r\nThe answer to 1 is <span class=\"answer\">0.0553</span><br>\r\nThe answer to 2 is <span class=\"answer\">0</span><br>\r\n\r\nAlso, compare with the Gaussian approximation where $\\hat \\lambda  \\sim N(\\lambda, \\lambda / t)$\r\n\r\n```r\r\npnorm(15800 / 30, mean = 520, sd = sqrt(520 / 30), lower.tail = FALSE)\r\n```\r\n\r\n```\r\n[1] 0.05466\r\n```\r\n\r\nAs $t\\rightarrow \\infty$ this becomes more Gaussian. The approximation is pretty good for this\r\nsetting.\r\n\r\n\r\n--- &multitext\r\n\r\nSuppose that in an AB test, one advertising scheme led to an average of 10 purchases per day for a sample of 100 days, while the other led to 11 purchaces per day, also for a sample of 100 days.\r\nAssuming a common standard deviation of 4 purchaces per day.\r\nAssuming that the groups are independent and that they days are iid, perform a Z test of\r\nequivalence. \r\n\r\n1. What is the P-value reported to 3 digits expressed as a proportion?\r\n2. Do you reject the test? (O for no 1 for yes).\r\n\r\n*** .hint\r\nThe standard error is \r\n$$\r\ns \\sqrt{\\frac{1}{n_1} + \\frac{1}{n_2}}\r\n$$\r\n\r\n*** .explanation\r\n\r\n```r\r\nm1 <- 10; m2 <- 11\r\nn1 <- n2 <- 100\r\ns <- 4\r\nse <- s * sqrt(1 / n1 + 1 / n2)\r\nts <- (m2 - m1) / se\r\npv <- 2 * pnorm(-abs(ts))\r\n```\r\n\r\n\r\nThe answer to 1 is <span class=\"answer\">0.077</span><br>\r\nThe answer to 2 is <span class=\"answer\">0</span>\r\n\r\n\r\n--- &radio\r\n\r\nA confidence interval for the mean contains:\r\n\r\n1. _All of the values of the hypothesized mean for which we would fail to reject with \r\n$\\alpha = 1 - Conf. Level$._\r\n2. All of the values of the hypothesized mean for which we would fail to reject with \r\n$2 \\alpha = 1 - Conf. Level$.\r\n3. All of the values of the hypothesized mean for which we would reject with \r\n$\\alpha = 1 - Conf. Level$.\r\n4. All of the values of the hypothesized mean for which we would fail to reject with \r\n$2 \\alpha = 1 - Conf. Level$.\r\n\r\n*** .hint\r\nThis is directly from the notes. Note that a confidence interval gives\r\nvalues of $\\mu$ that are supported by the data whereas a test rejects\r\nfor values of $\\mu$ different from $\\mu_0$. \r\n\r\n*** .explanation\r\nThe only complicated part of this is the 2. Note that a 95% interval corresponds\r\nto a 5% level two sided test. So it's $\\alpha = 1 - Conf.Level$. The confusion is that\r\nfor both the two sided test and confidence interval, one needs to calculate\r\n$Z_{1 - \\alpha / 2}$ (or the relevant T quantile).\r\n\r\n\r\n--- &multitext\r\nConsider two problems previous. Assuming that 10 purchases per day is a benchmark null value, \r\nthat days are iid and that the standard deviation is 4 purchases for day. Suppose that you\r\nplan on sampling 100 days. What would be the power for a one sided 5% \r\nZ mean test that purchases per day\r\nhave increased under the alternative of $\\mu = 11$ purchase per day?\r\n\r\n\r\n1. Give your result as a proportion to 3 decimal places.\r\n\r\n*** .hint\r\nUnder $H_0$ $\\bar X \\sim N(10, .4)$. Under $H_a$ $\\bar X \\sim N(11, .4)$. We reject\r\nwhen $\\bar X \\geq 10 + Z_{.95} .4$.\r\n\r\n\r\n*** .explanation\r\nThe hint prettty much gives it away.\r\n\r\n```r\r\npower <- pnorm(10 + qnorm(.95) * .4, mean = 11, sd = .4, lower.tail = FALSE)\r\n```\r\n\r\nThe answer is <span class=\"answer\">0.804</span>\r\n\r\n\r\n--- &multitext\r\nResearchers would like to conduct a study of healthy adults to detect a four year mean brain volume loss of .01 mm3. Assume that the standard deviation of four year volume loss in this population is .04 mm3. \r\n\r\n1. What is necessary sample size for the study for a 5% one sided test versus a null hypothesis of no volume loss to acheive 80% power? (Always round up)\r\n\r\n\r\n\r\n*** .hint\r\nUnder $H_0$ $\\bar X$ is $N(0, .05 / \\sqrt{n})$ and is $N(.01, .05 / \\sqrt{n})$ under $H_a$. \r\nWe will reject if \r\n$$\r\n\\bar X \\geq  Z_{.95} s / sqrt{n}\r\n$$ \r\nwhich has probability 0.05 under $H_0$. Under $H_a$ it has probability\r\n$$\r\nP\\left( \\frac{\\bar X - 0.01}{s / \\sqrt{n}} \\geq  \\frac{.01}{s / \\sqrt{n}} + z_{.95} \\right)\r\n= P\\left( Z \\geq \\frac{.01}{s / \\sqrt{n}} + z_{.95}\\right)\r\n$$\r\n\r\n*** .explanation\r\nLooking at the hint we set\r\n$$\r\n\\frac{.01}{s / \\sqrt{n}} + z_{.95} = z_{.2}\r\n$$\r\n$$\r\nn = \\frac{(z_{.95} - z_{.2})^2 s^2}{.01^2} = \\frac{ (z_{.95} + z_{.8})^2 s^2}{.01^2}\r\n$$\r\nSo we get\r\n\r\n```r\r\nn <- (qnorm(.95) + qnorm(.8)) ^ 2 * .04 ^ 2 / .01^2\r\n```\r\n\r\nThe answer is <span class=\"answer\">99</span>\r\n\r\n\r\n--- &radio\r\n\r\nIn a court of law, all things being equal, if via policy you require a lower\r\nstandard of evidence to convict people then\r\n\r\n1. Less guilty people will be convicted.\r\n2. _More innocent people will be convicted._\r\n3. More Innocent people will be not convicted.\r\n\r\n\r\n*** .hint\r\nThink about it.\r\n\r\n*** .explanation\r\nIf you require less evidence to convict, then you will convict more people, guilty and\r\ninnocent. Relate this property back to hypothesis tests.\r\n\r\n\r\n--- &multitext\r\nConsider the `mtcars` data set. \r\n\r\n1. Give the p-value for a t-test for assuming \r\nconstant variance comparing MPG for 6 and 8 cylinder cars as a proportion to 3 decimal places.\r\n2. Give the associated P-value for a z test.\r\n3. Give the common standard deviation estimate for MPG across cylinders to 3 decimal places.\r\n4. Would the t test reject at the two sided 0.05 level (0 for no 1 for yes)?\r\n\r\n\r\n*** .hint\r\n\r\n```r\r\nmpg8 <- mtcars$mpg[mtcars$cyl == 8]\r\nmpg6 <- mtcars$mpg[mtcars$cyl == 6]\r\nm8 <- mean(mpg8); m6 <- mean(mpg6)\r\ns8 <- sd(mpg8); s6 <- sd(mpg6)\r\nn8 <- length(mpg8); n6 <- length(mpg6)\r\n```\r\n\r\n\r\n*** .explanation\r\n\r\n```r\r\np <- t.test(mpg8, mpg6, paired = FALSE, alternative=\"two.sided\", var.equal=TRUE)$p.value\r\nmixprob <- (n8 - 1) / (n8 + n6 - 2)\r\ns <- sqrt(mixprob * s8 ^ 2  +  (1 - mixprob) * s6 ^ 2)\r\nz <- (m8 - m6) / (s * sqrt(1 / n8 + 1 / n6))\r\npz <- 2 * pnorm(-abs(z))\r\n## Hand calculating the T just to check\r\n#2 * pt(-abs(z), df = n8 + n6 - 2)\r\n```\r\n\r\n\r\n1. <span class=\"answer\">0</span> <br>\r\n2. <span class=\"answer\">0</span><br>\r\n3. <span class=\"answer\">2.27</span><br>\r\n4. <span class=\"answer\">1</span>\r\n\r\n\r\n--- &radio\r\nThe Bonferonni correction controls this\r\n\r\n1. False discovery rate\r\n2. _The familywise error rate_\r\n3. The rate of true rejections\r\n4. The number of true rejections\r\n\r\n*** .hint\r\nThis is pretty much straight out of the notes\r\n\r\n*** .explanation\r\nThe Bonferonni correction is the classic correction for the familywise error rate.\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}